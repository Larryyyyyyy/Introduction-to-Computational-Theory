# 第2章 难解性

~~是的，你甚至能学到第二章。~~

没有人真正理解$\bold{NP}$类的内在复杂性和结构，但一个合格的计算机科学家应能大致判断一个问题是否是$\text{NP}$-难的，就像一个合格的计算机科学家能凭直觉判断一个问题是否可计算。

## 2.1可验证性

> [!note]
>
> **定理2.1（高效可验证性）**：语言$L\subseteq\{0,1\}^*$在$\bold{NP}$中当且仅当存在多项式$p:\N \to\N$和多项式时间图灵机$\mathbb M$满足：对任意$x\in\{0,1\}^*$，下述等价关系成立：
> $$
> x\in L当且仅当\exist u\in\{0,1\}^{p(|x|)}.\mathbb M(x,u)=1
> $$
> 称$\mathbb M$为$L$的验证器。若$x$和$u$满足$|u|=p(|x|)$和$\mathbb M(x,u)=1$，称$u$为$x\in L$的**证书**（或**证明**）。

设非确定图灵机$\mathbb N$在多项式时间$p(n)$接受$L$。假定对任意输入串$x$，$\mathbb N(x)$的所有计算路径长度均为$p(|x|)$。$\mathbb M$作为$L$的验证器。一台非确定图灵机可以在多项式时间猜测一个长度为$p(|x|)$的证书$u$，然后计算$\mathbb M(x,u)$，这个$u$代表$\mathbb N$对迁移函数的选择。

---

$\bold{NP}$是所有具有**多项式长证明**的问题，$\bold P$是所有能在**多项式时间找出证明**的问题。

直觉上$\bold P\subseteq\bold{NP}$。

## 2.2NP-完全性

> [!note]
>
> **定义2.1**：若对任意$A\in\bold{NP}$，均有$A\le_K B$，称$B$为$\text{NP}$-难的。若$B$是$\text{NP}$-难的且$B\in\bold{NP}$，称$B$是$\text{NP}$-完全的。

搬运一个对卡普归约的理解：

> 譬如说你想证明某个问题$A$是$\text{NP}$-hard 的, 那么就假定你有求解这个问题对应的语言$L$的**神谕**。为了证明$\text{NP-hardness}$，你需要通过查询这个神谕来求解$\text{NP}$中的任何问题, 而你能用的就是一台确定性多项式时间的机器, 所以现在的问题是你允许怎么查询这个神谕：
>
> 如果只能调用神谕一次一次，这就是**Karp reduction**。

设$\bold{NPC}$为所有$\text{NP}$-完全问题类。解决了$\bold{NPC}$里的问题也就解决了所有$\text{NP}$问题。

若要证明一个问题是$\text{NP}$-完全的，就需要证明所有$\text{NP}$问题可以归约到该问题。那么我们要先找出一个$\text{NP}$-完全问题。

> [!note]
>
> **定理2.2（NP-完全问题的存在性）**：TMNP$=\{\lang\alpha,x,1^n,1^t\rang|\exist u\in\{0,1\}^n.\mathbb M_\alpha(x,u)在t步内输出1\}$是$\text{NP}$-完全的。

- $\alpha$是验证器$\mathbb{M}_\alpha$的编码。
- $x$是要解决的具体问题实例。
- $1^n$是证书$u$的最大长度。
- $1^t$是是验证过程的最大步数。

设$L\in\bold{NP}$有一个多项式$q(n)$时间验证器$\mathbb M$，证书的长度是多项式值$p(n)$。$x\in L\Leftrightarrow \exist u\in\{0,1\}^{p(|x|)}.\mathbb M(x,u)$在$q(|x|+p(|x|))$步内输出$1\Leftrightarrow\lang\llcorner\mathbb M\lrcorner,x,1^{p(|x|)},1^{q(|x|+p(|x|))}\rang\in$TMNP。我们需要的从$L$到TMNP的**卡普归约**将输入串$x$映射到四元组$\lang\llcorner\mathbb M\lrcorner,x,1^{p(|x|)},1^{q(|x|+p(|x|))}\rang$，归约时间是多项式的。

> 为什么选择$t=|x|+p(|x|)$？
>
> 因为这确保了$t$足够让验证器读完$x$并且读完整个证书$u$。
>
> 为什么要选择$1^n$和$1^t$？
>
> 因为模拟运行$t$步是多项式时间的，它相对于问题规模的“尺度”决定了时间的“尺度”。例如，如果$n$和$t$用二进制表示，那么问题规模就是对数级的，这时运行$t$步相对是指数级的，该问题就会变成$\bold{NEXPTIME}$-完全的。
>
> 我们会在后面对这个现象有更深刻的体会。

有了这个证明，就有$L\in\bold{NPC}\Leftrightarrow$TMNP$\le_KL\in\bold{NP}$。

## 2.3库克-莱文定理

> [!note]
>
> **定理2.3（库克-莱文定理）**：可满足性问题SAT是$\text{NP}$-完全的。

将判定一个$\text{NP}$-问题的验证器$\mathbb M$在输入$x$和证书$u$上的计算$\mathbb M(x,u)$用布尔公式$\psi_{\mathbb M,x}(u,y,z)$表示。

归约是对数空间的，因而是多项式空间的。

其中公式$\psi_{\mathbb{M}, x}(u, y, z)$是一个巨大的逻辑判断，它的变量被分为三组，分别代表计算过程的不同要素：

| 变量组 | 含义          | 作用                                                 |
| ------ | ------------- | ---------------------------------------------------- |
| $u$    | 证书变量      | 代表证书$u$的每一次迁移函数的选择。                  |
| $y$    | 时间/位置变量 | 代表计算过程中的时刻和读写头位置。                   |
| $z$    | 状态/内容变量 | 代表在某一时刻、某一读写头，图灵机的状态和磁带内容。 |

$\psi$做的就是，用逻辑语言写下**所有规则**，强制要求这些变量$u, y, z$的取值必须共同满足$\mathbb{M}$的有效计算历史。

具体来说：

取$t=q(|x|+p(|x|))$，构造一个$t\times t$的表格，第$i$行第$j$列的格子存储时刻$i$位于位置$j$的状态与内容。

定义
$$
X_{i,j,k}=\begin{cases}1,&如果时刻i、位置j的状态或内容是k，则为真\\0,&其它\end{cases}.
$$
构造$\psi_{\mathbb M,x}(u,y,z)$是下面四个部分的合取:
$$
\forall a,b\in\Gamma,c,d\in Q,a\ne b,c\ne d,\neg(X_{i,j,a}=1\land X_{i,j,b}=1\lor X_{i,j,c}=1\land X_{i,j,d}=1)
$$

$$
(X_{0,1,q_{start}}=1)\land(\forall j,X_{0,j,x_j}=1)\land(\forall j,X_{0,j,u_{j-|x|}}=1)
$$

$$
\forall i>0,j,((X_{i,j,k}=1\land X_{i,j,l}=1)\to(\exist e,r,\delta,(X_{i,j,e}=1\land X_{i,j,r}=1\land\delta((e,r))=(k,l))))
$$

$$
\exist i\le t,j,X_{i,j,q_{halt}}=1
$$

第一个：每个格子至多有一个状态和内容信息。

第二个：初始时刻一定包含开始状态并包含$x$和$u$。

第三个：初始时刻以外有信息的每个格子都存在上一个时刻某个格子通过迁移函数的转移。

第四个：$t$步内一定会停机。

由于$k$所属的符号集$\Gamma$和状态集$Q$大小是常数，所以$X_{i,j,k}$的变量数为$O(t^2)$是多项式级的。

而构造表格的过程只需要维护时间、空间、状态和内容的计数器，存储这些计数器只需要$O(\log(t))=O(\log(|x|))$空间。

由于对数空间归约($\bold{L}$)自动蕴含了多项式时间归约($\bold{P}$)，因此这个证明满足了所有$\mathbf{NP}$-完全性的要求。

所以$L \le_{\mathbf{L}} \text{SAT}$，所以$\text{SAT}$也是$\mathbf{NP}$-完全的。

---

设$\text{Ctf}(x)$为满足$\mathbb M(x,u)=1$的证书集合，$\text{Tas}(\psi_{\mathbb M,x}(u,y,z))$为满足$\psi_{\mathbb M,x}(u,y,z)=1$的证书集合，这里$\psi_{\mathbb M,x}(u,y,z)=1$的证书是使$\psi_{\mathbb M,x}(u,y,z)=1$为真的真值指派。根据$\mathbb M(x,u)$计算的唯一性，归约$\psi_{\mathbb M,\_}$是从$\text{Ctf}(x)$到$\text{Tas}(_{\mathbb M,x}(u,y,z))$的双射，其逆函数也是多项式时间可计算的。称满足这些性质的多项式时间归约为**莱文归约**。

搜索问题之间的归约必须是莱文归约。

我的理解是：$\bold{NP}$问题的莱文归约就是把它归约为合取范式的**搜索验证**，即若第一位的真值$0$不符合条件，则第一位赋为$1$，然后枚举第二位的真值...这个真值指派可以莱文归约为原问题的证书。

---

$A\le_K^1B$表示从$A$到$B$有个**单射**卡普归约。

$A\cong_pB$表示从$A$到$B$有个**双射**卡普归约，若$A\cong_pB$，称$A$和$B$为**多项式同构的**。

若从$A$到$B$的卡普归约$r$满足：对任意$x$有$|r(x)|>|x|$，称$r$为**严格增长的**。

若一个卡普归约$f$有一个多项式时间可计算的逆函数$f^{-1}$，称$f$为**可逆的**。

可逆的卡普归约$f$的逆函数也是卡普归约，并且$f$和$f^{-1}$都是单射。

以下是卡普的21个NP-完全问题：

$$
\begin{align}
&\text{SAT}\le_K\text{0-1-IntegerProgramming}\\
&~~~~~~~~\le_K\text{Clique}\\
&~~~~~~~~~~~~~~~\le_K\text{SetPacking}\\
&~~~~~~~~~~~~~~~\le_K\text{VertexCover}\\
&~~~~~~~~~~~~~~~~~~~~~~\le_K\text{SetCovering, FeedbackNodeSet, FeedbackArcSet}\\
&~~~~~~~~~~~~~~~~~~~~~~\le_K\text{DirectedHamiltonCircuit}\\
&~~~~~~~~~~~~~~~~~~~~~~~~~~~~~\le_K\text{UndirectedHC}\\
&~~~~~~~~\le_K\text{3SAT}\\
&~~~~~~~~~~~~~~~\le_K\text{ChromaticNumber}\\
&~~~~~~~~~~~~~~~~~~~~~~\le_K\text{CliqueCover}\\
&~~~~~~~~~~~~~~~~~~~~~~\le_K\text{ExactCover}\\
&~~~~~~~~~~~~~~~~~~~~~~~~~~~~~\le_K\text{HittingSet, SteinerTree, 3DimMatching}\\
&~~~~~~~~~~~~~~~~~~~~~~~~~~~~~\le_K\text{Knapsack}\\
&~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~\le_K\text{JobSequencing}\\
&~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~\le_K\text{Partition}\\
&~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~\le_K\text{MaxCut}\\
\end{align}
$$

> [!note]
>
> 它们依次是：
>
> - 0-1整数规划。
> - 判断图中是否存在大小为$k$的完全子图。
>   - 给定一个有限集合$S$及其子集列表，判定是否存在$k$个两两不相交的子集。
>   - 给定一个无向图$G=(V,E),|V|=N,|E|=M$，问是否存在一个不超过$K$个点的集合$S$，使得$G$中的每条边都至少有一个点在集合$S$中。
>     - 给定全集$U$，以及一个集合$S$满足$\bigcup_{A\in S}A=U$，找到$B\subseteq S$满足$\bigcup_{A\in B}A=U$。
>     - 给定一个图$G=(V, E)$，找到一个最小的顶点子集$S \subseteq V$，当我们从图$G$中移除$S$中的所有顶点及其关联的边后，剩余的图无环。
>     - 给定一个有向图$G=(V,E)$，找到一个最小的边子集$D\subseteq E$，当我们从图$G$中移除$D$中的所有边及因此孤立的点后，剩余的图无环。
>     - 判断有向图$G$有没有无重复遍历所有点的有向回路。
>       - 判断无向图$G$有没有无重复遍历所有点的回路。
> - 3-SAT。
>   - 给定一个无向图$G=(V,E)$，将$V$分为$k$个颜色组，每个组形成一个独立集。
>     - 一个图里面的所有点可否分成$k$个完全子图。
>     - 给定全集$U$，以及一个集合$S$满足$\bigcup_{A\in S}A=U$，找到$B\subseteq S$满足$B$是$U$的划分。
>       - 给定一组集合$S_i$，找到一个集合$H$，满足$\forall i,H\cap S_i\ne\empty$，$|H|\le k$。
>       - 给定一个带权图$G=(V,E)$，以及$R\in V$，找到图$G$的一个树$T$，使$T$的顶点集包含$R$，且$T$中所有边的权值总和最小。
>       - 给定三个不相交的集合$X,Y,Z,|X|=|Y|=|Z|=n$。给定$T\subseteq X\times Y \times Z,|T|=m$。求$T'\subseteq T$满足$|T'|=n$且恰好包含$X,Y,Z$每个元素一次。
>       - 背包问题
>         - 给定$n$个工作，每个工作包括它要做的时间、截止时间和迟到惩罚三个参数，判断是否存在顺序使得总惩罚不超过$k$。
>         - 判断$n$个正整数组成的集合是否可以分成和相等的两部分。
>           - 给定图$G=(V,E)$，将$V$划分为两个不相交的子集，使得这两个子集之间的边数最大化。

> [!note]
>
> **定理2.4（伯曼-哈特马尼斯定理）**：若有严格增长的可逆卡普归约$f:A\to B$和$g:B\to A$，则$A\cong_p B$。

对任意串$x$，序列
$$
x_0=x,x_1=g^{-1}(x_0),x_2=f^{-1}(x_1),x_3=g^{-1}(x_2),x_4=f^{-1}(x_3),\dots
$$
由$f^{-1},g^{-1}$单调递减，则序列长度不会大于$|x|$。

定义$h:A\to B$：

1. 若序列终止于某个偶数下标$x_{2i}$，称$x$为$A$-类的，设$h(x)=f(x)$。
2. 若序列终止于某个奇数下标$x_{2i+1}$，称$x$为$B$-类的，设$h(x)=g^{-1}(x)$。

若$\exist x_1,x_2,x_1\ne x_2,h(x_1)=h(x_2)$，则$x_1,x_2$必为不同类的，且$f(x_1)=g^{-1}(x_2)\Rightarrow g(f(x_1))=x_2$，则$x_1$是$A$-类的，$x_2$也是$A$-类的，矛盾。

所以$h$是单射。

显然$h$是满射，又$h$只调用了$O(|x|)$次$\{f,g,f^{-1},g^{-1}\}$，所以$h$是多项式时间可计算的。

因此$A\cong_pB$。

---

**伯曼-哈特马尼斯猜测**:所有NP-完全问题都是多项式同构的。

> [!note]
>
> **命题7**：若伯曼-哈特马尼斯猜测成立，则$\bold{NP}\ne\bold{P}$。

设$S\subseteq\{0,1\}^*$，$S^{\le n}$表示$S$中所有长度不超过$n$的串构成的集合。

若$|S^{\le n}|=2^{n^{O(1)}}$，称$S$为**稠密**的;若$|S^{\le n}|=n^{O(1)}$，称$S$为**稀疏**的。

> 通常可以这么理解稠密和稀疏：
>
> 如果增加1的问题规模，该问题最多增加多项式的解，那么它是稀疏的，比如：
> $$
> L=\{1^n|n是质数\},L\subseteq 增加一个数,它与之前的数是否互质
> $$
> 如果最少增加指数的解，那么它是稠密的，比如：
> $$
> L\subseteq SAT,L\subseteq 增加一个结点,找出所有包含至少一个回路的图
> $$

一个稠密的语言不可能与一个稀疏的语言多项式同构，不然设$L$为稠密，$L'$为稀疏，双射卡普归约函数$r:L\to L'$，则$r(L^{\le n})\subseteq(L')^{\le p(n)}$，前者是指数增长的，后者是多项式增长的，二者的数量级不对等，不能建立双射。

SAT是稠密的，P-问题$\{1^n|n\in\N\}$是稀疏的，因此它们不能多项式同构。

若$\bold{NP}=\bold{P}$，则$\bold{NPC}=\bold{P}$，即$\{1^n|n\in\N\}$也是NP-完全的，这与它们不能多项式同构矛盾。

---

$$
\text{THEOREM}=\{(\varphi,1^{|\varphi|^c})|\varphi有一个长度不超过|\varphi|^c的\mathcal A中的证明\}
$$

其中$\mathcal A$是任何熟知的公理系统。

结论是SAT可卡普归约为$\text{THEOREM}$，所以后者是NP完全的。

## 2.4拉德纳定理

我们好奇$\bold{NP}\setminus\bold P$中除了NP完全问题，还有其它NP问题吗。

> [!note]
>
> **定理2.5（拉德纳定理）**：若$\bold P\ne\bold{NP}$，则$\bold P\cup\bold{NPC}\ne\bold{NP}$。

SAT是NP-完全的，2-SAT是P问题，证明的思路是从SAT中删去足够多的元素，使得剩下的集合足够稀疏，使得不是NP完全的又不至于沦为P问题。

对于$\psi\in\text{SAT}$，把$\psi$变成$\psi\land v_1\land\dots\land v_h$，记为$\psi01^h$，其中$v_1,\dots,v_h$不出现在$\psi$里。$\psi$可满足当且仅当$\psi 01^h$可满足。

下面容易验证：

- $\{\psi01^{|\psi|^c}|\psi\in\text{SAT}\}$是NP-完全的；
- $\{\psi01^{2^{|\psi|}}|\psi\in\text{SAT}\}$是多项式时间可判定的。

> 设$L_1=\psi01^{|\psi|^c}$，$N_1=|L_1|$，$L_2=\psi01^{2^{|\psi|}}$，$N_2=|L_2|$。
> 验证器$\mathbb M_{L_1}$可以在$O(N_1)$时间内定位分隔符$0$并识别出公式$\psi$，验证$\psi$的时间是$O(2^{|\psi|})=O(N^{\frac1c})$，所以$\{{\psi01^{|\psi|^c}|\psi\in\text{SAT}}\}\in\bold{NP}$。
> 考虑$f:\text{SAT}\to\{\psi01^{|\psi|^c}|\psi\in\text{SAT}\}$，$f(\psi)=\psi01^{|\psi|^c}$，这个归约显然是$|\psi|$的多项式时间，所以有$\psi\in\text{SAT}\Leftrightarrow f(\psi)\in\{\psi01^{|\psi|^c}|\psi\in\text{SAT}\}$即$\text{SAT}\le_K\{\psi01^{|\psi|^c}|\psi\in\text{SAT}\}$，所以$\{\psi01^{|\psi|^c}|\psi\in\text{SAT}\}\in\bold{NPC}$。
> 同样地，验证器$\mathbb M_{L_2}$验证$\psi$的时间是$O(2^{|ψ|})=O(2\log N_2)=O(N_2)$，在庞大的$1$串的影响下，$\{\psi01^{2^{|ψ|}}|\psi\in\text{SAT}\}\in\bold P$是成立的。

设$h(n)=|\psi|^{H(|\psi|)}$，我们必须定义一个增长速度恰当的函数$H$。设
$$
\text{SAT}_H=\left\{\psi01^{|\psi|^{H(|\psi|)}}|\psi\in\text{SAT}\right\}
$$
并定义
$$
\text{SAT}_H(x)=\begin{cases}1,&若x\in\text{SAT}_H\\0,&若x\notin\text{SAT}_H\end{cases}
$$
拉德纳给出的函数$H$定义如下：
$$
H(n)=\begin{cases}&i是满足①和②的最小下标:\\i&①i<\log\log n;\\&②对所有满足|x|\le\log n的x,\mathbb M_i(x)在i|x|^i步内输出\text{SAT}_H(x)\\\log\log n,&否则\end{cases}
$$
函数$H$满足如下性质：

1. $H$是非递减函数。若$H(n)=\log\log n$，则$\log\log n\le H(n+1)$；否则$\forall i<H(n)$，即$i$不满足$H(n)$相应的性质，则$i$也一定不满足$H(n+1)$相应的性质，则$i<H(n+1)$。
2. $H$可在多项式时间内计算：
   - 根据条件①和条件②，被模拟的图灵机个数不超过$\log\log n$，长度不超过$\log n$的串的个数不超过$O(n)$。通用图灵机对每个$\mathbb M_i(x)$的模拟时间不超过$c(\log\log\log n)C\log C$，其中$C=(\log\log n)(\log n)^{\log\log n}$代表$\mathbb M_i$的时间函数。显然$c(\log\log\log n)C\log C=o(n)$。
   - 判定每个$x$是否$x\in\text{SAT}_H$，用暴力法判定$x\in\text{SAT}_H$的时间是$O(n)$。
   - 计算$H$在一个长度不超过$|x|\le\log n$的输入上的值，通过递归调用，$T(|x|)\le T(\log n)$。

$H(n)$的时间函数$T(n)$满足：
$$
T(n)\le(\log\log n)O(n)(o(n)+O(n)+T(\log n)+O(1))
$$
其中$\log\log n$来自对$i$的枚举，$O(n)$来自所有$|x|\le\log n$的串的个数，即
$$
T(n)=o(n^3).
$$
假定$\mathbb M_i$在$cn^c$步判定$\text{SAT}_H$。取$i\ge c$，按照定义，对所有足够大的$n$有$H(n)\le i$，由$H$非递减，存在常数$D$，对所有$n\ge D$，$H(x)$是常函数$\Rightarrow\text{SAT}\le_K\text{SAT}_H$。所以$\text{SAT}_H\in\bold{P}$蕴含$\bold{NP}=\bold P$，矛盾。所以$H$不会为常函数，$H(\N)$是无限集。

设$\text{SAT}_H$是NP-完全的，一定有某个多项式$dn^d$时间内可计算的规约函数$r:\text{SAT}\to\text{SAT}_H$，$\exist N$，当$|\psi|>d$和
$$
|r(\varphi)|=|\psi01^{|\psi|^{H(|\psi|)}}|>N
$$
时，有$H(|\psi|)>2d+1$。因此，$|\psi|^{2d+1}<|\psi|^{H(|\psi|)}<|r(\varphi)|\le d|\varphi|^d<|\psi|\cdot|\varphi|^d$。由此推得$|\psi|<\sqrt{|\varphi|}$。

可定义判定$\text{SAT}$的递归算法$Sat(\varphi)$如下：

1. 计算$r(\varphi)$，结果将形如$\psi01^{|\psi|^{H(|\psi|)}}$。
2. 若$|r(\varphi)|>N$，递归调用$\text{Sat}(\psi)$，否则用暴力法判定$\varphi$的可满足性。

此算法的递归调用深度$k$满足$1\le|\varphi|^{2^{-k}}\le N$，即$k\le\log\log|\varphi|$，所以$\text{Sat}$为多项式算法，矛盾。

综上，$\text{SAT}_H\notin\bold{NPC}$。

## 2.5贝克-吉尔-索罗维定理

> [!note]
>
> **定理2.6（贝克-吉尔-索罗维定理)**：存在$A$和$B$使得$\bold P^A=\bold{NP}^A$且$\bold{P}^B\ne\bold{NP}^B$。

取$A$为$\bold{PSPACE}$-完全问题QBF，因为$\bold{PSPACE}=\bold{P}^\bold{PSPACE}\subseteq\bold{NP}^{\bold{PSPACE}}=\bold{PSPACE}$，所以$\bold{P}^A=\bold{NP}^A$。

构造$B_0\subseteq B_1\subseteq B_2\subseteq \dots$，$n_0<n_1<n_2<\dots$。设$B_0=\empty$和$n_0=0$，试从$B_i$构造$B_{i+1}$。

1. 确保$n_{i+1}>n_i$,$n_{i+1}$大于构造$B_1,\dots,B_i$时所询问过的所有问题的长度。
2. 让$\mathbb M_i^{B_i}(1^{n_{i+1}})$计算$2^{n_{i+1}-1}$步。
   1. 若计算未终止，定义$B_{i+1}=B_i$。
   2. 若接受，定义$B_{i+1}=B_i$。
   3. 若拒绝，定义$B_{i+1}=B_i\cup\{s\}$，其中$s$是任意一个满足$|s|=n_{i+1}$并且在计算$\mathbb M_i^{B_i}(1^{n_{i+1}})$时没被当作问题问神谕$B_i$的0-1串。

定义$B=\bigcup_{i\in\N}B_i$,并定义$U_B$为问题$\{1^n|B包含一个长度为n的0-1串\}$。

$U_B\in\bold{NP}^B$因为非确定图灵机$\N^B$只需要猜测一个0-1串再问神谕$B$。

假设$\mathbb M_i^B$在多项式时间$T(n)$内判定$U_B$。取满足$T(n_i)<2^{n_i-1}$的足够大的$i$。按定义，$\mathbb M_i^B(1^{n_{i+1}})=0$，当且仅当$B$不含有长度是$n_{i+1}$的0-1串，当且仅当$B_{i+1}$不含有长度是$n_{i+1}$的0-1串，当且仅当$\mathbb M_i^{B_i}(1^{n_{i+1}})=1$推出$\mathbb M_i^{B_{i+1}}(1^{n_{i+1}})=1$，进而$\mathbb M_i^B(1^{n_{i+1}})=1$，矛盾。所以$U_B\notin\bold{P}^B$。
